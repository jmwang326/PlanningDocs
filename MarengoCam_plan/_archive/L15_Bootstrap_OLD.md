# Level 15 - Bootstrapping Technical Specification

## 1. Purpose
This document provides the technical specification for the bootstrapping tools and processes. It details the components required to process historical data and seed the system's knowledge bases as outlined in `L5_Bootstrap.md`.

## 2. Components

### 2.1. Offline Track Generator (`bootstrap_tracks.py`)

- **Input:** Path to a directory of historical video files.
- **Functionality:**
    - Iterates through each video file.
    - Uses a library like `OpenCV` to read frames.
    - Processes each frame with the standard YOLO11 detection and tracking model.
    - For each track identified by the tracker, it creates a `track` record.
    - **Output:** A set of CSV files or a temporary SQLite database containing all raw `track` and `detection` data for the entire historical period. This data is NOT yet in the main `marengo.db`.

### 2.2. Conservative Merger & Grid Learner (`bootstrap_learn.py`)

- **Input:** The raw track data generated by the `bootstrap_tracks.py` script.
- **Functionality:**
    - Loads all tracks into memory or an efficient query structure.
    - Iterates through pairs of tracks from different cameras.
    - Applies a **highly restrictive** merging algorithm. This algorithm should only consider merges where there is significant temporal and spatial overlap (i.e., `delta_t` is very close to zero and bounding boxes are in a known overlap zone).
    - For each high-confidence merge, it calculates the `delta_time_ms`.
    - It then connects to the main `marengo.db` and updates the `inter_camera_adjacency` table, inserting or updating the `min_travel_time_ms` for the corresponding cells.

### 2.3. Re-ID Data Exporter (`bootstrap_reid_data.py`)

- **Input:** The main `marengo.db` after the conservative merger has run.
- **Functionality:**
    - Queries the database for all `agents` that have more than a certain number of validated tracks (e.g., > 5).
    - For each of these agents, it iterates through their associated `tracks`.
    - From each track, it extracts a configurable number of high-quality image crops (based on detection confidence, image size, and potentially blur detection).
    - **Output:** A directory structure organized for Re-ID model training. For example:
      ```
      reid_training_data/
      ├── agent_001/
      │   ├── track_abc_crop_01.jpg
      │   ├── track_abc_crop_02.jpg
      │   └── ...
      ├── agent_002/
      │   ├── track_def_crop_01.jpg
      │   └── ...
      └── ...
      ```
    - This structured output can then be directly used as the input for a separate Re-ID model fine-tuning script.

## 3. Status
This document is a placeholder and is considered **in-progress**. The specific command-line arguments, configuration files, and implementation details of these scripts need to be further defined.
